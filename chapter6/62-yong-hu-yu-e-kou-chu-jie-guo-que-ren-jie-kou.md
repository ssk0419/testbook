## **接口说明** {#接口说明}

**该接口由开发者开放给变现猫，变现猫进行调用**

不管余额扣除行为最终成功还是失败，变现猫都会向开发者发出通知。

开发者收到通知后，请以变现猫订单号 orderNum 为准进行处理，改变订单状态，如果扣除成功，开发者在系统内标记此订单为成功状态即可。如果扣除失败，开发者需要将该订单标记为失败，并将之前扣余额接口预扣的余额返还给用户。

无论接受到的结果如何，只要开发者收到该请求，请返回 ok 字符串（不含双引号），否则变现猫将进行重复通知，直到开发者收到或者24小时内最多重复 8 次

**接口地址：在开发者后台接口配置模块配置**\(URL以http:\/\/开头\)

```
示例：http://www.xxx.com/api/deductAppBalanceConfirmApi.json

```

**输入参数：**

| **参数** | **是否必须** | **参数类型** | **限制长度** | **参数说明** |
| :--- | :--- | :--- | :--- | :--- |
| appUid | yes | string | 255 | app用户id |
| appKey | yes | string | 255 | 接口appKey，应用的唯一标识 |
| timestamp | yes | string | 20 | 服务器当前时间，1970-01-01开始的时间戳，毫秒为单位。 |
| orderNum | yes | string | 255 | 变现猫订单号\(请记录到数据库中\) |
| status | yes | string | 50 | 订单状态，成功：ok，失败：fail |
| sign | yes | string | 255 | MD5签名,将URL中每个参数值和appSecret（appSecret在开发者后台接口配置处可查看密钥）按照参数名称升序，拼接然后md5转码 详见MD5签名规则[http://www.bianxianmao.com/doc/md5.html](http://www.bianxianmao.com/doc/md5.html)） |

**响应参数：**

开发者服务器端收到通知并处理完成后，请返回成功状态，变现猫在验证到响应为 ok 后会标记相应订单余额支付成功。

如果响应为非 ok 字符串，变现猫会在24小时内最多重试8次通知（累计最多询问8次）。

| **参数** | **是否必须** | **参数类型** | **限制长度** | **参数说明** |
| :--- | :--- | :--- | :--- | :--- |
| status | yes | string | 255 | 查询状态，回复ok或者fail |
| errorMessage | no | string | 255 | 出错原因\(请用utf-8进行URL编码，防止中文乱码,javaURL编解码详见[http://blog.csdn.net/u011627980/article/details/50911249](http://blog.csdn.net/u011627980/article/details/50911249)\) |

请按JSON格式返回结果。

**响应示例：**

成功：

```
{
 'status': 'ok',
 'errorMessage': ''
}

```

失败：

```
{
 'status': 'fail',
 'errorMessage': '失败原因'
}

```

**重复通知处理**

由于网络具有不稳定的特性，当变现猫向开发者服务器发送成功、失败通知时，有可能存在变现猫发送了通知，开发者收到了通知并进行了处理。但是返回的信息，变现猫没有收到。此时，变现猫会认为开发者没有收到通知，于是进行重复通知。

每次开发者收到通知后，务必根据orderNum字段确认此订单是否已经处理过。如果已经处理过，则忽略此通知，并响应ok。如果此时开发者没有判断是非处理过，进行了重复处理，将导致开发者反复向用户返还余额，导致严重损失！

